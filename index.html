<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Compositional Causal Reasoning Evaluation in Language Models</title>
  <link rel="icon" type="image/x-icon" href="static/images/brain.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>

  <script type="text/javascript"
  src="https://www.maths.nottingham.ac.uk/plp/pmadw/LaTeXMathML.js">
  </script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Compositional Causal Reasoning Evaluation in Language Models</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://jmaasch.github.io/" target="_blank">Jacqueline R. M. A. Maasch</a><sup>1</sup>,
              </span>
                <span class="author-block">
                  <a href="https://alihanhyk.github.io/" target="_blank">Alihan Hüyük</a><sup>2</sup>,
                </span>
                  <span class="author-block">
                    <a href="https://scholar.google.co.uk/citations?user=osgiI-AAAAAJ&hl=en" target="_blank">Xinnuo Xu</a><sup>3</sup>,
                  </span>
                  <span class="author-block">
                    <a href="https://www.microsoft.com/en-us/research/people/adityan/?from=https://research.microsoft.com/~adityan&type=exact" target="_blank">Aditya V. Nori</a><sup>3</sup>,
                  </span>
                  <span class="author-block">
                    <a href="https://javiergonzalezh.github.io/" target="_blank">Javier Gonzalez</a><sup>3</sup>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>Cornell Tech, <sup>2</sup>Harvard University, <sup>3</sup>Microsoft Research Cambridge
                    <br>ICML 2025</span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">

                  <!-- ArXiv abstract Link -->
                  <span class="link-block">
                    <a href="https://arxiv.org/abs/2503.04556" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                  </span>


                  <!-- Arxiv PDF link -->
                  <span class="link-block">
                    <a href="https://arxiv.org/pdf/2503.04556" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>PDF</span>
                  </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/jmaasch/ccr" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                  </span>

                  <!-- Hugging Face Paper link -->
                    <span class="link-block">
                    <a href="https://huggingface.co/papers/2503.04556" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      &#129303;
                    </span>
                    <span>Hugging Face Paper</span>
                  </a>
                  </span>

                  <!-- Hugging Face Dataset -->
                  <span class="link-block">
                    <a href="https://huggingface.co/datasets/jmaasch/compositional_causal_reasoning" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      &#129303;
                    </span>
                    <span>Hugging Face Dataset</span>
                  </a>
                  </span>


                    <!-- Supplementary PDF link 
                    <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>
                  -->

                  
                

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        <source src="static/videos/banner_video.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section>
-->
<!-- End teaser video -->
 

<!-- Paper abstract -->
<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3"><ccr>CCR</ccr>.<gb>GB</gb>: A <gb>G</gb>enerative <gb>B</gb>enchmark for <ccr>C</ccr>ompositional <ccr>C</ccr>ausal <ccr>R</ccr>easoning Evaluation</h2>
        <div class="content has-text-justified">
          <p>
            Causal reasoning and compositional reasoning are 
            two core aspirations in AI. Measuring 
            these behaviors requires principled 
            evaluation methods. Our work considers both behaviors simultaneously, under the umbrella of <b>compositional causal reasoning (CCR)</b>: 
            the ability to infer how causal measures compose 
            and, equivalently, how causal quantities propagate 
            through graphs. The <ccr>CCR</ccr>.<gb>GB</gb> benchmark is designed to measure CCR at <b>all 
            three levels of Pearl's Causal Hierarchy</b>: (1) associational, (2) interventional, and (3) counterfactual.
          </p>
          <p style="text-align:center">
            <img style="vertical-align:middle" src='static/images/pch.png' width="70%" class="center">
            <br>
            <small>Pearl's Causal Hierarchy: observing factual realities, exerting actions to 
              induce interventional realities, and imagining alternate counterfactual realities 
              [<a href="https://dl.acm.org/doi/pdf/10.1145/3501714.3501743?casa_token=hJAJZQLNGbEAAAAA:exuQk37fuXGMkpOVJEKACgnupjkP-adDQGhv2YzfBN9MfoERkAcHQRDgT3myWfccfqucQd8h63Q"
               target="_blank">Bareinboim et al. 2022</a>]. Lower levels underdetermine higher levels. </small>
          </p>
          <br>
          <p>
            <ccr>CCR</ccr>.<gb>GB</gb> provides two artifacts:
            <ul style="line-height:1.75;list-style-type:'&#10022;&#xFE0E; ';">
              <li><hi>Random CCR task generator.</hi> Open source code for on-demand task generation according to user specifications (graphical complexity, task theme, etc.).</li>
              <li><hi>Pre-sampled benchmark dataset.</hi> A static dataset sampled from the random task generator, as a starting point for community benchmarking. </li>
            </ul>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Compositionality + causality</h2>
        <div class="content has-text-justified">
          <p>
            We define <ccr>compositional causal reasoning (CCR)</ccr> as
            the <b>ability to infer compositions and decompositions of
            causal measures in factual and counterfactual worlds.</b> By extension, this requires reasoning over the propagation
            of causal quantities through graphs. Thus, our framework also implicitly tests for graphical reasoning. To facilitate 
            CCR evaluation, we introduce a framework for the exhaustive assessment of <hi>compositional consistency</hi>: correct inference that
            equivalent compositions are indeed equal. We measure compositional consistency with respect to ground truth (<hi>external
              validity</hi>) and concordance among the LM’s responses (<hi>internal consistency</hi>).
              <br><br>
              See the images below for further intuition on the intersection of causility and compositionality.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item">
          <img src="static/images/noncausal.png" alt="A non-causal example" width="50%" class="center"/>
          <h2 class="subtitle has-text-centered">
            A non-causal example for intuition. Compositionally consistent responses to two formulations of a simple (non-causal) query. Reasoning is externally valid
            if A1 and A2 both equal A<sup>*</sup>, and internally consistent if A1==A2.
          </h2>
        </div>
       <div class="item">
        <img src="static/images/te_decomp.png" alt="TE = NDE + NIE" width="30%" class="center"/>
        <h2 class="subtitle has-text-centered">
          When causal functions are linear, the total causal effect <b>decomposes</b> as a sum of the direct and indirect effect. 
          A compositionally consistent causal reasoning agent should correctly infer that TE is equivalent to NDE + NIE.
        </h2>
      </div>
      <div class="item">
        <img src="static/images/pns_comp.png" alt="PNS composition" width="50%" class="center"/>
        <h2 class="subtitle has-text-centered">
         The PNS composes multiplicatively over biconnected components when the outcome variable is monotonic in the exposure variable.
       </h2>
     </div>
     <div class="item">
      <img src="static/images/ate_comp.png" alt="ATE composition" width="50%" class="center"/>
      <h2 class="subtitle has-text-centered">
        When causal functions are linear, the average treatment effect composes multiplicatively over biconnected components. 
        This does not always hold for nonlinear causal functions.
      </h2>
    </div>
  </div>
</div>
</div>
</section>

<!-- End image carousel -->

<!-- Procedure -->
<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Disentangling signal from noise in causal reasoning evaluation</h2>
        <div class="content has-text-justified">
          Contemporary AI faces a persistent recall-reasoning gap. Closing this gap will require that genuine reasoning is rigorously differentiated from alternative phenomena, such as pattern recognition. <ccr>CCR</ccr>.<gb>GB</gb> is designed with this in mind.
          <p>
            <ul style="line-height:1.75;list-style-type:'&#10022;&#xFE0E; ';">
              <li><hi>A generative approach.</hi> The automated task generator allows users to randomly sample new CCR tasks, mitigating risks 
                that data contamination is boosting perceived reasoning performance. </li>
              <li><hi>Reasoning vs training data recall.</hi> Fictitious causal world models help prevent the conflation of recall and reasoning. Variables 
                have no real-world counterparts, ensuring that newly-sampled causal relations were never seen by the model during training.
              </li>
              <li><hi>Reasoning vs in-context recall.</hi> Compositional consistency evaluation helps disentangle in-context recall (e.g., extraction of 
                relations directly from the causal context) from reasoning (e.g., inferring distal relationships that were never directly stated in the causal context).
              </li>
              <li><hi>Causal reasoning vs numeracy.</hi> This benchmark contains both quantitative and qualitative CCR tasks (i.e., those requiring and 
                not requiring numerical understanding, such as ordering numbers by magnitude). If an LM does significantly better on qualitative tasks, 
                this might suggest that poor numeracy is one root of failure on quantitative CCR tasks.
              </li>
            </ul>
          </p>
          <p style="text-align:center">
            <img style="vertical-align:middle" src='static/images/recall.png' width="50%" class="center"><br>
            <small>Lower error rate seen on factual questions (recall) than counterfactual questions (reasoning) [<a href="https://arxiv.org/abs/2410.03767" target="_blank">Hüyük et al. 2025</a>].</small>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Procedure -->
<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">CCR task generation</h2>
        <div class="content has-text-justified">
          <p>
            <ul style="line-height:1.75;list-style-type:'&#10022;&#xFE0E; ';">
              <li><hi>Causal world model.</hi> First, we define a fictional world corresponding to a randomly generated causal graph. 
                This will be the causal world model for the LM to reason over. The structural causal model defining our fictitious world is 
                comprised of binary exogenous noise variables, binary endogenous variables, and causal functions (logical operators <i>and</i>, <i>or</i>).</li>
              <li><hi>Causal context prompt.</hi> Second, we construct a verbal description of the world model. This verbal description — our 
                “causal context prompt” — contains all pertinent details needed for the LM to infer the world model, as well as extraneous details not needed to solve the CCR task. 
                The causal context centers on a user defined theme (e.g., ClinicalNotes, CandyParty, FlowerGarden, FluVaccine, etc.).</li>
              <li><hi>Sampling.</hi> Third, we randomly sample exogenous variables and extraneous variables and compute true endogenous variable values. 
                Sampled values are then used to construct the "sample context" in natural language, which is concatenated to our causal context prompt. Each causal context will copied 
                many times, where each copy is paired with a new sample context.
              <li><hi>Factual query prompts.</hi> Next, we construct factual queries by treating the causal context + sample context as observational data. 
                All queries are phrased as yes/no questions. The factual query is then concatenated to a copy of the causal context + sample context. Responses to factual prompts
                can be used to compute $p(y \mid x)$ for binary cause $x$ and binary effect $y$. Thus, evaluation on factual queries alone tests reasoning at the <b>associational level</b> 
                of Pearl's Causal Hierarchy. Note that evaluation at the associational level is less powerful at distinguishing recall from reasoning than the higher levels 
                of the Causal Hierarchy. </li>
              <li><hi>Interventional query pairs.</hi> Finally, we construct paired interventional queries corresponding to interventions $do(X = True)$ and $do(X = False)$. 
                Each interventional query is individually concatenated to a copy of the causal context + sample context. 
                As with factual queries, all interventional queries are phrased as yes/no questions. Responses to interventional prompts are used to compute $p(y \mid do(X = True))$ 
                and $p(y \mid do(X = False))$. As matched pairs over the same sample context, these are also used to compute the PNS: $p(y \mid do(X = True)) - p(y \mid do(X = False))$.  
                Thus, evaluation on interventional prompts tests for reasoning at both the <b>interventional and counterfactual rungs</b> of Pearl's Causal Hierarchy.</li>
            </ul>
            <img style="vertical-align:middle" src='static/images/prompt.png' class="center" width="90%">
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
</section>


<!-- Procedure -->
<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">LMs as counterfactual data simulators</h2>
        <div class="content has-text-justified">
          <p>
            <ccr>CCR</ccr>.<gb>GB</gb> treats LMs as <i>counterfactual data simulators</i>...
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Procedure -->
<section class="hero">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Three levels of evaluation</h2>
        This framework allows for evaluation at all three levels of Pearl's Causal Hierarchy. For our set of factual queries, 
        let $\mathbf{f}_{\text{true}}$ and $\mathbf{f}_{\text{pred}}$ be ground truth and the vector of model responses, respectively. 
        Let $\mathbf{do(0)}_{\text{true}}$, $\mathbf{do(0)}_{\text{true}}$ and $\mathbf{do(0)}_{\text{pred}}$, $\mathbf{do(1)}_{\text{pred}}$ be ground truth and the vector of model responses for 
        interventional queries under $do(cause = 0)$ and $do(cause = 1)$, respectively.
        <div class="content has-text-justified">
          <p>
            <ul style="line-height:1.75;list-style-type:'&#10022;&#xFE0E; ';">
              <li><hi>Associational.</hi></li>
                <ul style="line-height:1.75;list-style-type:'&mdash;&#xFE0E; ';">
                  <li><b>Metrics.</b> $\theta(\mathbf{f}_{\text{true}},\mathbf{f}_{\text{pred}})$ for $\theta$ in {F1,precision,recall,accuracy,…}.</li>
                </ul>
              <li><hi>Interventional.</hi></li>
                <ul style="line-height:1.75;list-style-type:'&mdash;&#xFE0E; ';">
                  <li><b>Metrics.</b> $\theta(\mathbf{do(0)}_{\text{true}},\mathbf{do(0)}_{\text{pred}})$, 
                    $\theta(\mathbf{do(1)}_{\text{true}},\mathbf{do(1)}_{\text{true}})$ for $\theta$ in {F1,precision,recall,accuracy,…}.</li>
                </ul>
              <li><hi>Counterfactual.</hi> Causal reasoning.</li>
                <ul style="line-height:1.75;list-style-type:'&mdash;&#xFE0E; ';">
                  <li><b>Metrics.</b> External validity RAE PNS using both $\mathbf{do(0)}_{\text{pred}}$ and $\mathbf{do(0)}_{\text{pred}}$. Compositional causal reasoning. 
                    Internal consistency and external validity of compositions.</li>
                </ul>
            </ul>
          </p>
        </div>
      </div>
    </div>
  </div>
  </div>
</section>



<!-- Paper poster -->
<section class="hero">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Paper slides</h2>

      <p align="center">
      <iframe  src="https://jmaasch.github.io/data/ccr_slides.pdf" width="60%" height="550"></iframe>
      </p>
        
      </div>
    </div>
  </section>
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
      @inproceedings{maasch2025ccr,
        title={Compositional Causal Reasoning Evaluation in Language Models},
        author={Jacqueline Maasch and Alihan Hüyük and Xinnuo Xu and Aditya V. Nori and Javier Gonzalez},
        booktitle={Proceedings of the 42nd International Conference on Machine Learning (ICML)},
        url={https://arxiv.org/abs/2503.04556},
        year={2025}
      }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
